<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PPA - Plugin Options</title>
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="bootstrap-icons.css">
  <link rel="stylesheet" href="options.css">
</head>
<body class="bg-light">
  <div class="container-fluid py-4">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-10 col-xl-8">
        
        <!-- Header -->
        <div class="card mb-4 border-0 shadow-sm">
          <div class="card-body text-center py-4">
            <a href="https://ppa.guide" target="_blank" class="text-decoration-none">
              <img src="https://storage.googleapis.com/msgsndr/PdMChW3b3rqeve2L755O/media/67f68add6dd5a5cde93bc557.png" 
                   width="200" alt="PPA Data Loader Logo" class="mb-3">
            </a>
            <h1 class="h3 text-primary mb-1">Professional Profile Analytics</h1>
            <p class="text-muted mb-0">Chrome Extension Settings</p>
            <p class="text-muted small mt-1">
              <i class="bi bi-shield-check text-success me-1"></i>
              Human-like automation with natural delays and interactions - safe for your LinkedIn account
            </p>
          </div>
        </div>

        <div class="row g-4">
          
          <!-- Configuration Section -->
          <div class="col-12 col-lg-6">
            <div class="card h-100 border-0 shadow-sm">
              <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">
                  <i class="bi bi-gear-fill me-2"></i>Configuration
                </h5>
              </div>
              <div class="card-body">
                
                <!-- Email Configuration -->
                <div class="mb-4">
                  <label for="email" class="form-label fw-semibold">
                    <i class="bi bi-envelope me-1"></i>Email Address
                  </label>
                  <div class="input-group">
                    <input type="email" class="form-control" id="email" 
                           placeholder="Enter your PPA registration email">
                    <button class="btn btn-outline-primary" type="button" id="save-email">
                      <i class="bi bi-check-lg"></i>
                    </button>
                  </div>
                  <div class="form-text">Used for registration at PPA</div>
                  <div id="emailStatus" class="status-message mt-2"></div>
                </div>

                <!-- Upload Frequency -->
                <div class="mb-4">
                  <label for="uploadFrequency" class="form-label fw-semibold">
                    <i class="bi bi-clock me-1"></i>Upload Frequency
                  </label>
                  <div class="input-group">
                    <select id="uploadFrequency" class="form-select">
                      <option value="daily">Daily</option>
                      <option value="3days" selected>Every 3 days (Default)</option>
                    </select>
                    <button class="btn btn-outline-primary" type="button" id="saveFrequency">
                      <i class="bi bi-check-lg"></i>
                    </button>
                  </div>
                  <div id="frequencyStatus" class="status-message mt-2"></div>
                </div>

                <!-- Advanced Post Statistics -->
                <div class="mb-3">
                  <div class="d-flex align-items-center justify-content-between">
                    <div>
                      <label class="form-label fw-semibold mb-1">
                        <i class="bi bi-graph-up me-1"></i>Advanced Post Statistics
                      </label>
                    </div>
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" id="advancedPostStats">
                    </div>
                  </div>
                  
                  <!-- Posts Limit Slider -->
                  <div id="postsLimitContainer" class="mt-3" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                      <label for="postsLimit" class="form-label mb-0 small text-muted">
                        <i class="bi bi-sliders me-1"></i>
                        Number of posts to process:
                      </label>
                      <span id="postsLimitValue" class="badge bg-primary">30</span>
                    </div>
                    <input type="range" class="form-range" id="postsLimit" min="5" max="50" value="30" step="5">
                    <div class="d-flex justify-content-between small text-muted">
                      <span>5</span>
                      <span>50</span>
                    </div>
                  </div>
                  
                  <div class="alert alert-warning py-2 mb-0" role="alert">
                    <small>
                      <i class="bi bi-info-circle me-1"></i>
                      <strong>Note:</strong> When enabled, the download & upload process will run significantly longer 
                      as each individual post will be accessed for detailed statistics. The process uses human-like 
                      simulation with natural delays and interactions, ensuring <strong>no risk</strong> of LinkedIn account blocking.
                    </small>
                  </div>
                  <div id="advancedStatsStatus" class="status-message mt-2"></div>
                </div>

              </div>
            </div>
          </div>

          <!-- Status & Company Section -->
          <div class="col-12 col-lg-6">
            
            <!-- Execution Status -->
            <div class="card mb-4 border-0 shadow-sm">
              <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">
                  <i class="bi bi-activity me-2"></i>Execution Status
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-12">
                    <div class="d-flex align-items-center">
                      <i class="bi bi-clock-history text-muted me-2"></i>
                      <div>
                        <div class="fw-semibold">Next Execution</div>
                        <div id="nextExecution" class="text-muted small">Loading...</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="d-flex align-items-center">
                      <i class="bi bi-check-circle text-muted me-2"></i>
                      <div>
                        <div class="fw-semibold">Last Execution</div>
                        <div id="lastExecution" class="text-muted small">Checking...</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="d-flex align-items-center">
                      <i class="bi bi-bell text-muted me-2"></i>
                      <div>
                        <div class="fw-semibold">Alarm Status</div>
                        <div id="alarmStatus" class="text-muted small">Checking...</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Company Page Analytics -->
            <div class="card border-0 shadow-sm">
              <div class="card-header bg-warning text-dark">
                <h5 class="card-title mb-0">
                  <i class="bi bi-house-door me-2"></i>Company Page Analytics
                </h5>
              </div>
              <div class="card-body">
                <p class="text-muted small mb-3">
                  Configure automatic download and upload of LinkedIn company page analytics data. 
                  Company page data is automatically uploaded once per week.
                </p>
                
                <div class="mb-3">
                  <label for="companyId" class="form-label fw-semibold">
                    <i class="bi bi-hash me-1"></i>LinkedIn Company ID
                  </label>
                  <div class="input-group">
                    <input type="text" class="form-control" id="companyId" 
                           placeholder="e.g., 105563936" maxlength="20">
                    <button class="btn btn-outline-secondary" type="button" id="save-company-id">
                      <i class="bi bi-check-lg"></i>
                    </button>
                  </div>
                  <div id="companyIdStatus" class="status-message mt-2"></div>
                </div>

                <!-- Company Status -->
                <div class="bg-light rounded p-3 mb-3">
                  <h6 class="fw-semibold mb-2">Upload Status</h6>
                  <div class="small">
                    <div class="mb-1 d-flex align-items-center">
                      <i class="bi bi-clock-history text-muted me-2"></i>
                      <span class="text-muted me-2">Next Upload:</span>
                      <span id="nextCompanyExecution">Loading...</span>
                    </div>
                    <div class="d-flex align-items-center">
                      <i class="bi bi-check-circle text-muted me-2"></i>
                      <span class="text-muted me-2">Last Upload:</span>
                      <span id="lastCompanyExecution">Checking...</span>
                    </div>
                  </div>
                </div>

                <!-- Help Section -->
                <div class="collapse" id="companyHelp">
                  <div class="card card-body bg-light border-0">
                    <h6 class="fw-semibold">How to find your Company ID:</h6>
                    <ol class="small mb-2">
                      <li>Go to your LinkedIn company page admin panel</li>
                      <li>Navigate to Analytics → Updates</li>
                      <li>Look at the URL: <code>https://www.linkedin.com/company/[COMPANY-ID]/admin/analytics/updates/</code></li>
                      <li>Copy the number between "company/" and "/admin"</li>
                    </ol>
                    <div class="bg-primary bg-opacity-10 p-2 rounded">
                      <strong class="small">Example:</strong><br>
                      <code class="small">https://www.linkedin.com/company/105563936/admin/analytics/updates/</code><br>
                      <strong class="small">Company ID: 105563936</strong>
                    </div>
                  </div>
                </div>
                <button class="btn btn-outline-info btn-sm w-100" type="button" 
                        data-bs-toggle="collapse" data-bs-target="#companyHelp"
                        aria-expanded="false" aria-controls="companyHelp" id="companyHelpBtn">
                  <i class="bi bi-question-circle me-1"></i>
                  <span id="helpBtnText">Show Help - How to find Company ID</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Manual Actions Section -->
          <div class="col-12">
            <div class="card border-0 shadow-sm">
              <div class="card-header bg-secondary text-white">
                <h5 class="card-title mb-0">
                  <i class="bi bi-play-circle me-2"></i>Manual Actions
                </h5>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-12 col-md-6">
                    <div class="card bg-light border-0 h-100">
                      <div class="card-body text-center">
                        <i class="bi bi-person-circle text-primary fs-1 mb-3"></i>
                        <h6 class="card-title">Personal Profile Analytics</h6>
                        <p class="card-text small text-muted mb-3">
                          Download and upload 28 days of LinkedIn analytics data
                        </p>
                        <button id="run-script" class="btn btn-primary">
                          <i class="bi bi-download me-1"></i>Run Now
                        </button>
                        <div class="mt-2">
                          <small class="text-muted">
                            <i class="bi bi-info-circle me-1"></i>Email must be configured
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-md-6">
                    <div class="card bg-light border-0 h-100">
                      <div class="card-body text-center">
                        <i class="bi bi-house-door text-warning fs-1 mb-3"></i>
                        <h6 class="card-title">Company Page Analytics</h6>
                        <p class="card-text small text-muted mb-3">
                          Download and upload company page analytics data
                        </p>
                        <button id="run-company-script" class="btn btn-warning">
                          <i class="bi bi-download me-1"></i>Run Now
                        </button>
                        <div class="mt-2">
                          <small class="text-muted">
                            <i class="bi bi-info-circle me-1"></i>Company ID must be configured
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <script src="xlsx.full.min.js"></script>
  <script src="excel-processor.js"></script>
  <script src="bootstrap.bundle.min.js"></script>
  <script src="options-bootstrap.js"></script>
  <script src="options.js"></script>
</body>
</html>
